# =============================================================================
# Foundry Secrets
# SCALE Tier - Task T159
#
# Kubernetes Secrets for sensitive configuration
# NOTE: In production, these should be managed by external secret management
# (e.g., HashiCorp Vault, AWS Secrets Manager, Azure Key Vault)
# =============================================================================

{{- if .Values.secrets.create }}

---
# JWT Secrets
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "foundry.fullname" . }}-jwt-secret
  labels:
    {{- include "foundry.labels" . | nindent 4 }}
type: Opaque
data:
  # IMPORTANT: Replace these with your own base64-encoded secrets
  # Generate: echo -n "your-secret" | base64
  secret: {{ "REPLACE_WITH_JWT_SECRET" | b64enc | quote }}
  refreshSecret: {{ "REPLACE_WITH_JWT_REFRESH_SECRET" | b64enc | quote }}

---
# Encryption Secrets
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "foundry.fullname" . }}-encryption-secret
  labels:
    {{- include "foundry.labels" . | nindent 4 }}
type: Opaque
data:
  # Generate encryption key: openssl rand -hex 32 | base64
  key: {{ "REPLACE_WITH_ENCRYPTION_KEY" | b64enc | quote }}
  sessionSecret: {{ "REPLACE_WITH_SESSION_SECRET" | b64enc | quote }}

---
# PostgreSQL Secret (if not using external)
{{- if .Values.postgresql.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Values.postgresql.auth.existingSecret }}
  labels:
    {{- include "foundry.labels" . | nindent 4 }}
type: Opaque
data:
  password: {{ "REPLACE_WITH_POSTGRES_PASSWORD" | b64enc | quote }}
  postgres-password: {{ "REPLACE_WITH_POSTGRES_PASSWORD" | b64enc | quote }}
{{- end }}

---
# Redis Secret (if not using external)
{{- if .Values.redis.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Values.redis.auth.existingSecret }}
  labels:
    {{- include "foundry.labels" . | nindent 4 }}
type: Opaque
data:
  password: {{ "REPLACE_WITH_REDIS_PASSWORD" | b64enc | quote }}
{{- end }}

---
# Neo4j Secret
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "foundry.fullname" . }}-neo4j-secret
  labels:
    {{- include "foundry.labels" . | nindent 4 }}
type: Opaque
data:
  password: {{ "REPLACE_WITH_NEO4J_PASSWORD" | b64enc | quote }}

{{- end }}

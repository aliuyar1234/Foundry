# =============================================================================
# Foundry ConfigMap
# SCALE Tier - Task T158
#
# Kubernetes ConfigMap for non-sensitive configuration
# =============================================================================

apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "foundry.fullname" . }}-config
  labels:
    {{- include "foundry.labels" . | nindent 4 }}
data:
  # Logging
  LOG_LEVEL: {{ .Values.config.logLevel | quote }}

  # CORS Configuration
  {{- if .Values.config.corsOrigins }}
  CORS_ORIGINS: {{ .Values.config.corsOrigins | quote }}
  {{- end }}

  # Feature Flags
  ENABLE_ANALYTICS: {{ .Values.config.enableAnalytics | quote }}
  ENABLE_PROCESS_DISCOVERY: {{ .Values.config.enableProcessDiscovery | quote }}
  ENABLE_AI_INSIGHTS: {{ .Values.config.enableAiInsights | quote }}

  # Rate Limiting
  RATE_LIMIT_WINDOW_MS: {{ .Values.config.rateLimitWindowMs | quote }}
  RATE_LIMIT_MAX_REQUESTS: {{ .Values.config.rateLimitMaxRequests | quote }}

  # Database Hosts (non-sensitive)
  POSTGRES_HOST: {{ include "foundry.postgresql.host" . | quote }}
  POSTGRES_PORT: {{ include "foundry.postgresql.port" . | quote }}
  POSTGRES_DB: {{ include "foundry.postgresql.database" . | quote }}

  REDIS_HOST: {{ include "foundry.redis.host" . | quote }}
  REDIS_PORT: {{ include "foundry.redis.port" . | quote }}

  NEO4J_HOST: {{ include "foundry.neo4j.host" . | quote }}
  NEO4J_PORT: {{ include "foundry.neo4j.port" . | quote }}

  {{- if or .Values.qdrant.enabled .Values.externalQdrant.host }}
  QDRANT_HOST: {{ include "foundry.qdrant.host" . | quote }}
  QDRANT_PORT: {{ include "foundry.qdrant.port" . | quote }}
  {{- end }}
